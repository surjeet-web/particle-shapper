<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Whimsical Rating System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        :root {
            --purple-bare: #F8EDFF;
            --purple-light: #e7cafa;
            --purple-core: #7E26C8;
            --purple-dark: #62457a;
            --red: #e3468a;
            --red-dark: #9e1852;
            --gold: #faf18f;
            --teal: #ace4eb;
            --pink: #f0a6df;
            --yellow: #FFD700;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(135deg, #1a0b2e, #2d1b42);
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #f0a6df, #7E26C8);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.8;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.5;
        }

        .rating-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .avatar-container {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 0 auto 20px;
        }

        #avatar {
            position: relative;
            width: 100%;
            height: 100%;
            transition: all 0.3s ease;
        }

        /* Confetti elements */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--gold);
            opacity: 0.8;
            border-radius: 50%;
            z-index: 10;
        }

        .star-effect {
            position: absolute;
            font-size: 2rem;
            color: var(--yellow);
            opacity: 0;
            z-index: 20;
            pointer-events: none;
        }

        .rating-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            width: 100%;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        legend {
            margin: 0 0 1.5em;
            display: block; 
            width: 100%;
            font-size: 1.4rem; 
            font-weight: 600; 
            text-align: center;
            color: var(--purple-light);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .rate-radios {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
            position: relative;
        }

        input[type="radio"] {
            position: absolute; 
            top: auto; 
            z-index: 2;
            width: 1.5em; 
            height: 2em;
            -webkit-appearance: none; 
            -moz-appearance: none; 
            appearance: none;
            opacity: .0001;
        }

        .rate-radio {
            margin: 0 0.5em 0 0;
            position: relative;	
            display: inline-block; 
            vertical-align: top;
            color: #2a2a2a; 
            line-height: 1;
            cursor: pointer;
            transition: all 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .rate-radio:last-of-type {
            margin-right: 0;
        }

        .rate-radio svg {
            display: block;
            width: 3.5em; 
            height: 3.35em;
            fill: var(--purple-bare);
            stroke: #000; 
            stroke-width: 3px; 
            stroke-linejoin: round;
            transform: scale(.625);
            transition: transform 0.3s ease-in-out;
            overflow: visible;
        }

        .rate-radio span {
            padding: .4em .5em;	
            position: absolute; 
            left: 50%; 
            top: 100%;
            background: rgba(51, 51, 51, 0.8); 
            border: solid 2px var(--purple-dark); 
            border-radius: .25em;
            color: #fff; 
            font-size: .8em; 
            font-weight: 600;
            text-align: center; 
            white-space: nowrap;	
            opacity: 0;
            transform: translateY(.5em) translateX(-50%) scale(0);
            transition:
                opacity .25s ease-in-out,
                transform .25s ease-in-out;
            backdrop-filter: blur(5px);
        }

        .rate-radio span::before {
            content: "";
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: -1;
            width: 100%; 
            height: 100%;
            border-radius: inherit;
            background: var(--purple-core);
            opacity: 0;
            transition: opacity .25s ease;
        }

        .rate-radio--none svg {
            width: 3.35em; 
            height: 3.35em;
            fill: #FFF; 
            stroke: var(--red-dark);
        }

        input:focus + .rate-radio {
            outline: dotted .25em rgba(255, 255, 255, 0.5); 
            outline-offset: .5em;
        }

        fieldset:not([disabled]) input:not([disabled]):hover + .rate-radio span,
        .rate-radio:hover span,
        input:focus + .rate-radio span {
            opacity: 1;
            transform: translateY(.5em) translateX(-50%) scale(1);
        }

        fieldset:not([disabled]) input:not([disabled]):checked + .rate-radio span,
        .rate-radio:checked span,
        input:checked + .rate-radio span {
            opacity: 1;
            background: rgba(126, 38, 200, 0.8);
            transform: translateY(.5em) translateX(-50%) scale(1);
        }

        input:checked + .rate-radio span {
            background: rgba(51, 51, 51, 0.8);
            border: 2px solid var(--purple-dark);
        }

        input:checked ~ .rate-radio svg {
            fill: var(--purple-bare);
            transform: scale(.625);
        }

        input:not(:checked) ~ .rate-radio--none svg {
            fill: var(--purple-dark);
            transform: scale(.625);
        }

        .rate-radio svg, 
        input:checked + .rate-radio svg {
            fill: var(--yellow); 
            stroke: var(--purple-dark);
            transform: scale(1) translateY(-.25em);
        }

        input:checked + .rate-radio--none svg {
            fill: var(--red); 
            stroke: var(--red-dark);
            transform: scale(1);
        }

        /* Animation for stars on hover */
        .rate-radio:hover svg {
            animation: starPulse 0.6s ease-in-out;
        }

        @keyframes starPulse {
            0%, 100% { transform: scale(0.625); }
            50% { transform: scale(0.8); }
        }

        /* Reactions container */
        .reactions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .reaction {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 50px;
            padding: 8px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .reaction:hover {
            background: rgba(126, 38, 200, 0.3);
            transform: translateY(-3px);
        }

        .reaction.selected {
            background: var(--purple-core);
            box-shadow: 0 0 15px rgba(126, 38, 200, 0.5);
        }

        /* Floating elements */
        .floating {
            position: absolute;
            z-index: -1;
            animation: float 8s infinite ease-in-out;
            opacity: 0.1;
        }

        .floating.star {
            font-size: 1.5rem;
            color: var(--gold);
        }

        .floating.circle {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--teal);
        }

        .floating.triangle {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 30px solid var(--pink);
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(10px, -15px) rotate(5deg); }
            50% { transform: translate(-10px, -25px) rotate(-5deg); }
            75% { transform: translate(15px, -10px) rotate(3deg); }
        }

        /* Submit button */
        .submit-btn {
            display: block;
            margin: 30px auto 0;
            padding: 12px 35px;
            background: linear-gradient(45deg, #7E26C8, #f0a6df);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(126, 38, 200, 0.4);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(126, 38, 200, 0.6);
        }

        .submit-btn:active {
            transform: translateY(1px);
        }

        /* Funny messages */
        .message {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2rem;
            font-weight: 500;
            min-height: 30px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .message.show {
            opacity: 1;
        }

        /* Background particles */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            background: var(--gold);
            border-radius: 50%;
            opacity: 0.3;
            animation: particleFloat 15s infinite linear;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.3;
            }
            90% {
                opacity: 0.3;
            }
            100% {
                transform: translateY(-100vh) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive design */
        @media (max-width: 600px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .avatar-container {
                width: 200px;
                height: 200px;
            }
            
            .rate-radio svg {
                width: 3em;
                height: 2.85em;
            }
            
            .reactions {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Rate Our Magical Unicorn!</h1>
            <p class="subtitle">Select a rating and watch our unicorn react with hilarious animations and expressions!</p>
        </div>
        
        <div class="rating-container">
            <div class="avatar-container">
                <div id="avatar" aria-hidden="true">
                    <div>
                        <svg xmlns="http://www.w3.org/2000/svg" focusable="false" viewBox="0 0 350 350" width="200">
                            <!-- SVG content remains the same -->
                        </svg>
                    </div>
                </div>
            </div>
            
            <div class="rating-card">
                <form action="#" method="post">
                    <fieldset class="rate-radios">
                        <legend>How magical is our unicorn?</legend>

                        <input checked type="radio" name="rate-input" id="rate-input_0" data-num="0">
                        <label for="rate-input_0" class="rate-radio rate-radio--none">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#no-rating"/>
                            </svg>
                            <span role="presentation">No rating</span>
                        </label>

                        <input type="radio" name="rate-input" id="rate-input_1" data-num="1">
                        <label for="rate-input_1" class="rate-radio">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#star"/>
                            </svg>
                            <span role="presentation">1 Star</span>
                        </label>

                        <input type="radio" name="rate-input" id="rate-input_2" data-num="2">
                        <label for="rate-input_2" class="rate-radio">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#star"/>
                            </svg>
                            <span role="presentation">2 Stars</span>
                        </label>

                        <input type="radio" name="rate-input" id="rate-input_3" data-num="3">
                        <label for="rate-input_3" class="rate-radio">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#star"/>
                            </svg>
                            <span role="presentation">3 Stars</span>
                        </label>

                        <input type="radio" name="rate-input" id="rate-input_4" data-num="4">
                        <label for="rate-input_4" class="rate-radio">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#star"/>
                            </svg>
                            <span role="presentation">4 Stars</span>
                        </label>

                        <input type="radio" name="rate-input" id="rate-input_5" data-num="5">
                        <label for="rate-input_5" class="rate-radio">
                            <svg aria-hidden="true" focusable="false">
                                <use xlink:href="#star"/>
                            </svg>
                            <span role="presentation">5 Stars</span>
                        </label>
                    </fieldset>
                </form>
                
                <div class="reactions">
                    <div class="reaction" data-reaction="love">‚ù§Ô∏è Love it!</div>
                    <div class="reaction" data-reaction="lol">üòÇ Hilarious</div>
                    <div class="reaction" data-reaction="wow">üòÆ Amazing</div>
                    <div class="reaction" data-reaction="sad">üò¢ Sad unicorn</div>
                </div>
                
                <div class="message" id="ratingMessage"></div>
                
                <button class="submit-btn">Submit Rating</button>
            </div>
        </div>
    </div>
    
    <div class="particles" id="particles"></div>
    
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">
        <symbol id="star" viewBox="0 0 48 45.7">
            <path d="M24 37.9L9.2 45.7 12 29.1 0 17.4 16.6 15 24 0l7.4 15L48 17.4 36 29.1l2.8 16.6z"/>
        </symbol>
        <symbol id="no-rating" viewBox="0 0 44 44">
            <path d="M22 0C9.9 0 0 9.9 0 22s9.9 22 22 22 22-9.9 22-22S34.1 0 22 0zm16 22c0 3.3-1 6.4-2.8 9L13 8.8C15.6 7 18.7 6 22 6c8.8 0 16 7.2 16 16zM6 22c0-3.3 1-6.4 2.8-9L31 35.2C28.4 37 25.3 38 22 38c-8.8 0-16-7.2-16-16z"/>
        </symbol>
    </svg>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/MorphSVGPlugin.min.js"></script>
    <script>
        // Create floating background elements
        function createFloatingElements() {
            const container = document.querySelector('.container');
            const types = ['star', 'circle', 'triangle'];
            
            for (let i = 0; i < 15; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                const el = document.createElement('div');
                el.classList.add('floating', type);
                
                // Random position
                const left = Math.random() * 100;
                const top = 20 + Math.random() * 80;
                el.style.left = `${left}%`;
                el.style.top = `${top}%`;
                
                // Random delay and duration
                const delay = Math.random() * 5;
                const duration = 10 + Math.random() * 10;
                el.style.animationDelay = `${delay}s`;
                el.style.animationDuration = `${duration}s`;
                
                container.appendChild(el);
            }
        }
        
        // Create background particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size
                const size = 2 + Math.random() * 8;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                const left = Math.random() * 100;
                particle.style.left = `${left}%`;
                
                // Random color
                const colors = ['#f0a6df', '#7E26C8', '#ace4eb', '#faf18f'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.background = color;
                
                // Random animation delay and duration
                const delay = Math.random() * 15;
                const duration = 10 + Math.random() * 10;
                particle.style.animationDelay = `${delay}s`;
                particle.style.animationDuration = `${duration}s`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Create confetti effect
        function createConfetti() {
            const avatarContainer = document.querySelector('.avatar-container');
            const confettiCount = 50;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                
                // Random color
                const colors = ['#f0a6df', '#7E26C8', '#ace4eb', '#faf18f', '#e3468a'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.background = color;
                
                // Random position
                const left = 30 + Math.random() * 40;
                const top = 30 + Math.random() * 40;
                confetti.style.left = `${left}%`;
                confetti.style.top = `${top}%`;
                
                // Random size
                const size = 4 + Math.random() * 8;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                // Random rotation
                const rotation = Math.random() * 360;
                confetti.style.transform = `rotate(${rotation}deg)`;
                
                avatarContainer.appendChild(confetti);
                
                // Animate confetti
                gsap.to(confetti, {
                    y: -100,
                    x: (Math.random() - 0.5) * 100,
                    opacity: 0,
                    scale: 0.5,
                    duration: 1 + Math.random() * 1,
                    ease: "power1.out",
                    onComplete: () => confetti.remove()
                });
            }
        }
        
        // Create star burst effect
        function createStarBurst() {
            const avatar = document.getElementById('avatar');
            
            for (let i = 0; i < 10; i++) {
                const star = document.createElement('div');
                star.classList.add('star-effect');
                star.innerHTML = '‚≠ê';
                
                // Position at center of avatar
                star.style.left = '50%';
                star.style.top = '50%';
                star.style.transform = 'translate(-50%, -50%)';
                
                avatar.appendChild(star);
                
                // Animate star
                gsap.to(star, {
                    y: -100,
                    x: (Math.random() - 0.5) * 200,
                    opacity: 1,
                    scale: 1.5,
                    rotation: Math.random() * 360,
                    duration: 1.5,
                    ease: "power1.out",
                    onComplete: () => star.remove()
                });
            }
        }
        
        // Show funny messages based on rating
        function showRatingMessage(rating) {
            const messages = [
                "The unicorn is crying in the corner...",
                "Ouch! That hurt the unicorn's feelings!",
                "The unicorn is giving you side-eye...",
                "Not bad! The unicorn is smiling!",
                "Wow! The unicorn is doing a happy dance!",
                "AMAZING! The unicorn is over the moon!"
            ];
            
            const messageElement = document.getElementById('ratingMessage');
            messageElement.textContent = messages[rating];
            messageElement.classList.add('show');
            
            // Hide message after 5 seconds
            setTimeout(() => {
                messageElement.classList.remove('show');
            }, 5000);
        }
        
        // Set up the rating functionality
        function setupRating() {
            const inputs = document.querySelectorAll('input[type="radio"]');
            const reactions = document.querySelectorAll('.reaction');
            const submitBtn = document.querySelector('.submit-btn');
            const horn1 = document.getElementById('horn-1');
            const horn2 = document.getElementById('horn-2');
            const horn3 = document.getElementById('horn-3');
            const horn4 = document.getElementById('horn-4');
            const horn5 = document.getElementById('horn-5');
            const earL = document.getElementById('ear-l');
            const earR = document.getElementById('ear-r');
            const earring = document.getElementById('earring');
            const pupil = document.getElementById('pupil');
            const eyePaths = document.querySelectorAll('.eye-path');
            const mouthPaths = document.querySelectorAll('.mouth-path');
            const chin = document.getElementById('chin');
            const tongue = document.getElementById('tongue');
            const toothTop = document.getElementById('tooth-top');
            const toothBot = document.getElementById('tooth-bot');
            const avatar = document.getElementById('avatar');
            
            let curRating = 0;
            let tl;
            let durReduced = 0, durNoPref = .5, dur;
            let eyeTarg, mouthTarg, chinY, pupilS, earS, earY, earRotL, earRotR, earringX, earringY, tongueY, toothTopY, toothBotY;
            const horns = [horn1, horn2, horn3, horn4, horn5];
            let hornsU = [], hornsD = horns;
            let mq;
            
            // Set up matchMedia for reduced motion
            mq = window.matchMedia('(prefers-reduced-motion: reduce)');
            if (mq.addEventListener) {
                mq.addEventListener('change', onReduceMotionMQ);
            } else {
                mq.addListener(onReduceMotionMQ);
            }
            onReduceMotionMQ();
            
            // Set initial visual properties
            gsap.set(earL, { transformOrigin: "40px 40px", rotate: "-15deg", y: 10, scale: .9 });
            gsap.set(earR, { transformOrigin: "40px 40px", rotate: "15deg", y: 10, scale: .9 });
            gsap.set(earring, { transformOrigin: "50% 0", x: -12, y: 8 });
            gsap.set(pupil, { transformOrigin: "50% 50%" });
            gsap.set(eyePaths, { morphSVG: eye0 });
            gsap.set(mouthPaths, { morphSVG: mouth0 });
            gsap.set(chin, { y: 0 });
            gsap.set(horn1, { transformOrigin: "20px 45px", scale: 0 });
            gsap.set(horn2, { transformOrigin: "12px 45px", scale: 0 });
            gsap.set(horn3, { transformOrigin: "32px 38px", scale: 0 });
            gsap.set(horn4, { transformOrigin: "12px 38px", scale: 0 });
            gsap.set(horn5, { transformOrigin: "50% 90%", scale: 0 });
            gsap.set(avatar, { opacity: 1 });
            
            // Add click handlers
            inputs.forEach(input => {
                input.addEventListener("click", onRatingClick);
            });
            
            reactions.forEach(reaction => {
                reaction.addEventListener('click', function() {
                    // Remove selected class from all
                    reactions.forEach(r => r.classList.remove('selected'));
                    // Add to clicked
                    this.classList.add('selected');
                });
            });
            
            submitBtn.addEventListener('click', function() {
                const selectedRating = document.querySelector('input[name="rate-input"]:checked');
                const ratingNum = selectedRating ? parseInt(selectedRating.dataset.num) : 0;
                
                if (ratingNum === 0) {
                    alert("Please select a rating before submitting!");
                    return;
                }
                
                // Show confirmation with animation
                gsap.fromTo(submitBtn, 
                    { scale: 1, background: "linear-gradient(45deg, #7E26C8, #f0a6df)" },
                    {
                        scale: 1.1,
                        background: "linear-gradient(45deg, #00C853, #64DD17)",
                        duration: 0.3,
                        yoyo: true,
                        repeat: 1,
                        onComplete: function() {
                            alert(`Thank you for your ${ratingNum}-star rating! The unicorn is grateful!`);
                            submitBtn.style.background = "linear-gradient(45deg, #7E26C8, #f0a6df)";
                        }
                    }
                );
            });
            
            function onRatingClick(e) {
                let num = parseInt(e.target.getAttribute('data-num'));
                tl = gsap.timeline({ paused: true, defaults: { duration: dur, ease: "sine.out" } });
                
                hornsU = horns.slice(0, num);
                if (hornsU.length > curRating) {
                    hornsU = hornsU.slice(curRating);
                }
                hornsD = horns.slice(num, curRating);
                
                switch (num) {
                    case 0:
                        eyeTarg = eye0;
                        mouthTarg = mouth0;
                        chinY = 0;
                        pupilS = 1;
                        earS = .9; earY = 10; earRotL = "-15deg"; earRotR = "15deg"; earringX = -12; earringY = 8;
                        tongueY = 0; toothTopY = 0; toothBotY = 0;
                        break;
                    case 1:
                        eyeTarg = eye1;
                        mouthTarg = mouth1;
                        chinY = 3;
                        pupilS = .84;
                        earS = 1.1; earY = -4; earRotL = "10deg"; earRotR = "-10deg"; earringX = 0; earringY = 0;
                        tongueY = 2; toothTopY = 5; toothBotY = -17;
                        break;
                    case 2:
                        eyeTarg = eye2;
                        mouthTarg = mouth2;
                        chinY = -2;
                        pupilS = .94;
                        earS = 1.05; earY = -2; earRotL = "5deg"; earRotR = "-5deg"; earringX = -2; earringY = -1;
                        tongueY = 0; toothTopY = 0; toothBotY = 0;
                        break;
                    case 3:
                        eyeTarg = eye3;
                        mouthTarg = mouth3;
                        chinY = -4;
                        pupilS = 1;
                        earS = 1; earY = 0; earRotL = "0deg"; earRotR = "0deg"; earringX = -4; earringY = -2;
                        tongueY = 0; toothTopY = 0; toothBotY = 0;
                        break;
                    case 4:
                        eyeTarg = eye4;
                        mouthTarg = mouth4;
                        chinY = 3;
                        pupilS = 1.1;
                        earS = .95; earY = -3; earRotL = "2deg"; earRotR = "-2deg"; earringX = -2; earringY = -5;
                        tongueY = -4; toothTopY = 6; toothBotY = -16;
                        createConfetti();
                        break;
                    case 5:
                        eyeTarg = eye5;
                        mouthTarg = mouth5;
                        chinY = 14;
                        pupilS = 1.2;
                        earS = .9; earY = -6; earRotL = "4deg"; earRotR = "-4deg"; earringX = 0; earringY = -10;
                        tongueY = 0; toothTopY = 2; toothBotY = -2;
                        createConfetti();
                        createStarBurst();
                        break;
                }
                
                tl
                    .to(eyePaths, { morphSVG: eyeTarg }, 0)
                    .to(mouthPaths, { morphSVG: mouthTarg }, 0)
                    .to(chin, { y: chinY }, 0)
                    .to(pupil, { scale: pupilS }, 0)
                    .to(earL, { scale: earS, y: earY, rotate: earRotL }, 0)
                    .to(earR, { scale: earS, y: earY, rotate: earRotR }, 0)
                    .to(earring, { x: earringX, y: earringY }, 0)
                    .to(tongue, { y: tongueY }, 0)
                    .to(toothTop, { y: toothTopY }, 0)
                    .to(toothBot, { y: toothBotY }, 0);
                
                if (hornsU.length) {
                    if (dur) {
                        gsap.to(hornsU, { scale: 1, stagger: { each: .1, ease: "power1.out" }, duration: dur, ease: "back.out" });
                    } else {
                        gsap.set(hornsU, { scale: 1 });
                    }
                }
                if (hornsD.length) {
                    if (dur) {
                        gsap.to(hornsD, { scale: 0, stagger: { each: -.08, ease: "power2.out" }, duration: dur, ease: "back.in" });
                    } else {
                        gsap.set(hornsD, { scale: 0 });
                    }
                }
                
                curRating = num;
                tl.play();
                
                // Show rating message
                showRatingMessage(num);
            }
            
            function onReduceMotionMQ() {
                dur = mq.matches ? durReduced : durNoPref;
            }
            
            // Path data for shape morphing
            const eye0 = "M175.4,75.3c-12,0-23.4-0.9-33.7-2.5c-4.2,6.4-6.7,14-6.7,22.2c0,12.4,5.7,23.5,14.6,30.9c6.9,5.7,15.8,9.1,25.4,9.1c9.7,0,18.5-3.4,25.4-9.1c8.9-7.3,14.6-18.4,14.6-30.9c0-8.2-2.5-15.8-6.7-22.1C198.3,74.5,187.1,75.3,175.4,75.3z";
            const eye1 = "M213.3,82.3c-9.7,4-23.1,6.5-37.9,6.5s-28.2-2.5-37.9-6.5c-1.3,4-2.1,8.3-2.1,12.8c0,11,4.4,20.9,11.6,28.1c8.2-1.8,18-2.9,28.4-2.9s20.2,1.1,28.4,2.9c7.2-7.2,11.6-17.2,11.6-28.1C215.4,90.6,214.6,86.3,213.3,82.3z";
            const eye2 = "M215.4,95.1c0-7.4-2-14.3-5.5-20.3c-9.3,2.5-21.3,4-34.5,4s-25.1-1.5-34.5-4c-3.5,6-5.5,12.9-5.5,20.3c0,13.1,6.3,24.7,16,32c7.2-1.1,15.4-1.7,24-1.7s16.8,0.6,24,1.7C209.1,119.8,215.4,108.2,215.4,95.1z";
            const eye3 = "M152.9,128.2c6.8-0.9,14.5-1.5,22.5-1.5s15.7,0.5,22.5,1.5c10.6-7.2,17.5-19.3,17.5-33.1c0-12.8-6-24.2-15.4-31.5c-7.4,2-15.7,3.2-24.6,3.2s-17.3-1.2-24.6-3.2c-9.4,7.3-15.4,18.7-15.4,31.5C135.4,108.8,142.3,121,152.9,128.2z";
            const eye4 = "M150.7,128.1c7.3-1.1,15.6-1.7,24.3-1.7s17,0.6,24.3,1.7c10.1-7.5,16.7-19.5,16.7-33c0-13.4-6.4-25.3-16.4-32.8c-6.9-5.2-15.4-8.2-24.6-8.2c-9.5,0-18.2,3.2-25.2,8.6c-9.6,7.5-15.8,19.2-15.8,32.4C134,108.6,140.6,120.6,150.7,128.1z";
            const eye5 = "M219,95.1c0,12-4.7,23-12.4,30.9c-7.9,8.1-19,13.1-31.6,13.1c-12.2,0-23.2-4.9-31.1-12.9c-8-8-12.9-19-12.9-31.1c0-13.7,6.2-25.9,16-34c7.6-6.3,17.4-10,28-10c9.9,0,19.1,3.3,26.4,8.8C212.1,67.9,219,80.7,219,95.1z";
            const mouth0 = "M174.6,178.2h5.1H215c0,0,0.1,0,0.1,0c0,0,0,0-0.1,0h-35.3L174.6,178.2l-4.6,0.1h-35c0,0-0.1,0-0.1,0c0,0,0,0,0.1,0h35H174.6z";
            const mouth1 = "M175,172.6h7c8.9,0,16.2,6.4,17.7,14.9c0.2,1,0.3,2,0.3,3.1c0,0.8-0.5,2-2,2l-16,0h-7h-7l-16,0c-1.4,0-2-1.2-2-2c0-1,0.1-1.9,0.2-2.8c1.4-8.6,8.8-15.1,17.7-15.1H175z";
            const mouth2 = "M175,187c5.5,0,9.7-2.1,13.8-4.1c5.5-2.7,11.3-5.5,17.6-0.4c0.1,0.1,0.3,0.3,0.2,0.4c-0.1,0.1-0.3,0.1-0.4,0c-5.6-5.1-11.7-2.6-17.4,0.2c-4.2,2-7.3,4.1-13.9,4.1c-6.5,0-9-2.1-12.9-4.1c-5.1-2.8-10.6-5.8-18.6-0.6c-0.1,0-0.1,0-0.1,0c0,0,0-0.1,0.1-0.1c7.9-5.4,13.4-2.4,18.8,0.5C165.9,185,169.7,187,175,187z";
            const mouth3 = "M175,179.8c2,0,4-0.1,6-0.2c11-0.9,22-4.1,32.9-9.7c0.1,0,0.2-0.1,0.2,0c0,0.1-0.1,0.2-0.2,0.2c-11.6,6-21.7,9-33,9.7c-2,0.1-4,0.3-6,0.3c-2.3,0-4.6-0.1-6.8-0.3c-10.9-0.8-20.8-3.9-32.1-9.7c-0.1,0-0.1-0.1-0.1-0.1c0,0,0.1,0,0.2,0c10.7,5.5,21.4,8.7,32.1,9.6C170.5,179.7,172.7,179.8,175,179.8z";
            const mouth4 = "M174.8,172.6h10H200l0,4.9c0,1.4-0.2,2.7-0.6,4c-1.8,5.9-7.5,10.1-14.3,10.1h-10.4h-9.9c-6.7,0-12.3-4.2-14.2-9.9c-0.4-1.3-0.7-2.7-0.7-4.2v-4.9h14.3H174.8z";
            const mouth5 = "M175,165.6h4.8l23.3,0c5.6,0,8.9,4.7,8.9,8.9c0,3-0.4,6-1.2,8.7c-3.8,14-16.7,24.3-31.9,24.3H175h-3.9c-15.5,0-28.6-10.7-32.1-25.2c-0.6-2.5-0.9-5.2-0.9-7.9c0-5,4.1-8.9,8.9-8.9l23.9,0H175z";
        }
        
        // Initialize everything
        document.addEventListener('DOMContentLoaded', function() {
            createFloatingElements();
            createParticles();
            setupRating();
        });
    </script>
</body>
</html>